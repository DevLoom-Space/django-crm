<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}CRM{% endblock %}</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">

  {% load static %}
  <link rel="stylesheet" href="{% static 'css/app.css' %}">
</head>

<body class="bg-light">

  <!-- Top Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark border-bottom sticky-top">
    <div class="container-fluid">
      <button class="btn btn-outline-light d-lg-none me-2" id="sidebarToggle" type="button" aria-label="Toggle sidebar">
        <i class="bi bi-list"></i>
      </button>

      <a class="navbar-brand fw-semibold d-flex align-items-center gap-2" href="{% url 'dashboard' %}">
        <span class="brand-dot"></span>
        DevLoom CRM
      </a>

      <div class="ms-auto d-flex align-items-center gap-2">
        {% if user.is_authenticated %}
          <span class="text-light small d-none d-sm-inline">
            <i class="bi bi-person-circle"></i> {{ user.username }}
          </span>
          <form method="post" action="{% url 'logout' %}" class="d-inline">
  {% csrf_token %}
  <button class="btn btn-sm btn-outline-light" type="submit">
    <i class="bi bi-box-arrow-right me-1"></i> Logout
  </button>
</form>

        {% else %}
<a class="btn btn-sm btn-outline-light" href="{% url 'signup' %}">
  <i class="bi bi-person-plus me-1"></i> Sign up
</a>
<a class="btn btn-sm btn-outline-light" href="{% url 'login' %}">
  <i class="bi bi-box-arrow-in-right me-1"></i> Login
</a>

        {% endif %}
      </div>
    </div>
  </nav>

  <div class="app-wrapper">
    <!-- Sidebar -->
    <aside class="app-sidebar bg-white border-end" id="sidebar">
      <div class="p-3">
        <div class="text-uppercase small text-muted mb-2">Navigation</div>

        <div class="list-group list-group-flush app-nav">
          <a class="list-group-item list-group-item-action" href="{% url 'dashboard' %}">
            <i class="bi bi-speedometer2 me-2"></i> Dashboard
          </a>
          <a class="list-group-item list-group-item-action" href="{% url 'company_list' %}">
            <i class="bi bi-building me-2"></i> Companies
          </a>
          <a class="list-group-item list-group-item-action" href="{% url 'contact_list' %}">
            <i class="bi bi-people me-2"></i> Contacts
          </a>
          <a class="list-group-item list-group-item-action" href="{% url 'deal_list' %}">
            <i class="bi bi-cash-coin me-2"></i> Deals
          </a>

<a class="list-group-item list-group-item-action" href="{% url 'deal_board' %}">
  <i class="bi bi-columns-gap me-2"></i> Pipeline Board
</a>



          <a class="list-group-item list-group-item-action" href="{% url 'activity_list' %}">
            <i class="bi bi-check2-square me-2"></i> Activities
          </a>
          <a class="list-group-item list-group-item-action" href="{% url 'note_list' %}">
            <i class="bi bi-journal-text me-2"></i> Notes
          </a>
        </div>

        <hr>

        <div class="text-uppercase small text-muted mb-2">Quick Actions</div>
        <div class="d-grid gap-2">
          <a class="btn btn-primary btn-sm" href="{% url 'deal_create' %}">
            <i class="bi bi-plus-circle me-1"></i> New Deal
          </a>
          <a class="btn btn-outline-primary btn-sm" href="{% url 'contact_create' %}">
            <i class="bi bi-person-plus me-1"></i> New Contact
          </a>
          <a class="btn btn-outline-primary btn-sm" href="{% url 'company_create' %}">
            <i class="bi bi-building-add me-1"></i> New Company
          </a>
        </div>
      </div>
    </aside>

    <!-- overlay for mobile sidebar -->
    <div class="sidebar-overlay d-lg-none" id="sidebarOverlay"></div>

    <!-- Main content -->
    <main class="app-main">
      <div class="container-fluid py-4">

        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-info mb-3" role="alert">
              {{ message }}
            </div>
          {% endfor %}
        {% endif %}

        {% block page_header %}{% endblock %}
        {% block content %}{% endblock %}
      </div>
    </main>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{% static 'js/app.js' %}"></script>
  <script src="{% static 'js/kanban.js' %}"></script>
</body>
</html>
